<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <title>EASY EARN BD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Inter', sans-serif;
      transition: all 0.3s ease;
    }
    
    body {
      margin: 0;
      padding: 30px 15px;
      background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      color: #f0f0f0;
    }
    
    body.dark-theme {
      background: linear-gradient(135deg, #0a061e, #1d1940, #141329);
    }
    
    .hidden { display: none !important; }
    
    .app, .ad-page, .referral-page, .notice-page, .withdraw-page, 
    .settings-page, .support-page, .top-users-page, .history-page {
      background: rgba(30, 26, 62, 0.65);
      backdrop-filter: blur(12px);
      border-radius: 24px;
      padding: 30px;
      width: 100%;
      max-width: 420px;
      box-shadow: 0 16px 40px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .app-name {
      text-align: center;
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 20px;
      background: linear-gradient(90deg, #00b09b, #96c93d);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      letter-spacing: -0.5px;
      text-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    
    .balance-section {
      background: linear-gradient(135deg, #1a1a3a, #2d2b55);
      color: white;
      border-radius: 20px;
      padding: 25px;
      margin-bottom: 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(0, 176, 155, 0.15);
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25);
    }
    
    .balance-section::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #00b09b, #96c93d);
    }
    
    .balance-section h2 { 
      margin: 0 0 10px; 
      font-size: 24px; 
      font-weight: 600;
      letter-spacing: -0.3px;
    }
    
    .balance-section p { 
      margin: 8px 0; 
      font-size: 17px; 
      font-weight: 500;
      color: rgba(255, 255, 255, 0.85);
    }
    
    .balance-section strong {
      font-weight: 600;
      color: #f0f0f0;
    }
    
    .grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }
    
    .card {
      background: linear-gradient(135deg, rgba(40, 36, 76, 0.7), rgba(30, 26, 62, 0.5));
      border-radius: 18px;
      padding: 20px 10px;
      text-align: center;
      cursor: pointer;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      transition: all 0.3s ease;
      border: 1px solid rgba(255, 255, 255, 0.08);
      position: relative;
      overflow: hidden;
    }
    
    .card::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #00b09b, #96c93d);
      opacity: 0;
      transition: opacity 0.3s ease;
    }
    
    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.35);
      border-color: rgba(0, 176, 155, 0.25);
    }
    
    .card:hover::before {
      opacity: 1;
    }
    
    .card:hover i {
      transform: scale(1.1);
    }
    
    .card i {
      font-size: 28px;
      color: #00b09b;
      margin-bottom: 12px;
      transition: all 0.3s ease;
    }
    
    .card span {
      display: block;
      font-size: 14px;
      font-weight: 500;
      color: rgba(255, 255, 255, 0.85);
      letter-spacing: -0.2px;
    }
    
    .back-btn {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 25px;
      color: #f0f0f0;
      cursor: pointer;
      background: rgba(40, 36, 76, 0.7);
      border-radius: 12px;
      padding: 12px 20px;
      width: fit-content;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .back-btn:hover {
      background: rgba(50, 46, 86, 0.8);
      transform: translateX(-3px);
    }
    
    .back-btn i {
      font-size: 18px;
    }
    
    .quiz-buttons button {
      background: linear-gradient(135deg, #00b09b, #96c93d);
      color: #1a1a2e;
      border: none;
      padding: 15px;
      font-size: 16px;
      font-weight: 600;
      border-radius: 14px;
      margin-bottom: 20px;
      width: 100%;
      cursor: pointer;
      box-shadow: 0 6px 16px rgba(0, 176, 155, 0.3);
      transition: all 0.3s ease;
      letter-spacing: -0.3px;
    }
    
    .quiz-buttons button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 176, 155, 0.4);
    }
    
    .modal {
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(10, 6, 30, 0.9);
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .modal-content {
      background: linear-gradient(135deg, #1a1a3a, #2d2b55);
      padding: 30px;
      border-radius: 20px;
      width: 90%;
      max-width: 420px;
      text-align: center;
      position: relative;
      box-shadow: 0 16px 40px rgba(0, 0, 0, 0.4);
      border: 1px solid rgba(0, 176, 155, 0.15);
    }
    
    .modal-content::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #00b09b, #96c93d);
    }
    
    .modal .close {
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 26px;
      font-weight: bold;
      cursor: pointer;
      color: #00b09b;
      transition: all 0.3s ease;
    }
    
    .modal .close:hover {
      transform: scale(1.1);
      color: #f0f0f0;
    }
    
    .quiz-question {
      font-weight: 600;
      margin-bottom: 25px;
      font-size: 19px;
      line-height: 1.5;
    }
    
    .timer {
      font-size: 18px;
      color: #00b09b;
      font-weight: 700;
      margin-bottom: 20px;
    }
    
    .quiz-options button {
      background: rgba(40, 36, 76, 0.7);
      color: #f0f0f0;
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 14px;
      margin: 12px 0;
      width: 100%;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 500;
      transition: all 0.3s ease;
    }
    
    .quiz-options button:hover {
      background: rgba(50, 46, 86, 0.9);
      border-color: rgba(0, 176, 155, 0.3);
    }
    
    .referral-page input {
      width: 100%;
      padding: 14px;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 15px;
      background: rgba(40, 36, 76, 0.5);
      color: #f0f0f0;
      margin-bottom: 15px;
    }
    
    .referral-page input:focus {
      outline: none;
      border-color: rgba(0, 176, 155, 0.3);
    }
    
    .notice-content, .withdraw-form, .theme-options, .support-options, .user-stats, .history-item {
      background: rgba(40, 36, 76, 0.6);
      border-radius: 20px;
      padding: 25px;
      margin-top: 25px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .notice-content h2, .withdraw-form h2, .support-options h2, .top-users-page h2, .history-page h2 {
      color: #00b09b;
      margin-top: 0;
      text-align: center;
      font-size: 24px;
      margin-bottom: 20px;
      letter-spacing: -0.5px;
    }
    
    .notice-content p, .withdraw-form p, .support-options p, .user-stats p {
      line-height: 1.7;
      font-size: 16px;
      margin-bottom: 15px;
      color: rgba(255, 255, 255, 0.85);
    }
    
    .notice-content strong, .withdraw-form strong, .support-options strong {
      color: #00b09b;
      font-weight: 600;
    }
    
    .theme-btn, .support-btn {
      display: flex;
      align-items: center;
      justify-content: flex-start;
      padding: 18px;
      margin: 18px 0;
      border-radius: 16px;
      cursor: pointer;
      background: rgba(40, 36, 76, 0.7);
      border: 1px solid rgba(255, 255, 255, 0.1);
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .theme-btn:hover, .support-btn:hover {
      background: rgba(50, 46, 86, 0.8);
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
    }
    
    .theme-btn i, .support-btn i {
      margin-right: 15px;
      font-size: 24px;
      color: #00b09b;
    }
    
    .light-btn {
      background: rgba(40, 36, 76, 0.7);
      color: #f0f0f0;
    }
    
    .dark-btn {
      background: rgba(40, 36, 76, 0.7);
      color: #f0f0f0;
    }
    
    .withdraw-form input, .withdraw-form select {
      width: 100%;
      padding: 15px;
      margin: 15px 0;
      border-radius: 14px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 16px;
      background: rgba(40, 36, 76, 0.5);
      color: #f0f0f0;
    }
    
    .withdraw-form select {
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%2300b09b' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 15px center;
      background-size: 16px;
    }
    
    .withdraw-form button {
      background: linear-gradient(135deg, #00b09b, #96c93d);
      color: #1a1a2e;
      border: none;
      padding: 16px;
      font-size: 17px;
      font-weight: 600;
      border-radius: 14px;
      width: 100%;
      cursor: pointer;
      margin-top: 20px;
      box-shadow: 0 6px 16px rgba(0, 176, 155, 0.3);
      transition: all 0.3s ease;
    }
    
    .withdraw-form button:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 20px rgba(0, 176, 155, 0.4);
    }
    
    .user-stats div {
      margin: 15px 0;
      padding: 15px;
      background: rgba(30, 26, 62, 0.5);
      border-radius: 14px;
      display: flex;
      justify-content: space-between;
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .history-item {
      margin-bottom: 20px;
      padding: 20px;
      background: rgba(40, 36, 76, 0.6);
      border-radius: 16px;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.08);
    }
    
    .history-item div {
      display: flex;
      justify-content: space-between;
      margin: 12px 0;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .history-item div:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }
    
    .level-bar {
      height: 12px;
      background-color: rgba(40, 36, 76, 0.8);
      border-radius: 8px;
      margin: 20px 0 10px;
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.05);
    }
    
    .level-progress {
      height: 100%;
      background: linear-gradient(90deg, #00b09b, #96c93d);
      border-radius: 8px;
      transition: width 0.5s ease;
      box-shadow: 0 0 15px rgba(0, 176, 155, 0.4);
    }
    
    .section-title {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 25px;
    }
    
    .section-title i {
      font-size: 28px;
      color: #00b09b;
    }
    
    .copy-btn {
      background: rgba(40, 36, 76, 0.7);
      color: #f0f0f0;
      border: 1px solid rgba(255, 255, 255, 0.1);
      padding: 10px 18px;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 500;
    }
    
    .copy-btn:hover {
      background: rgba(50, 46, 86, 0.8);
      border-color: rgba(0, 176, 155, 0.3);
    }
    
    .share-btn {
      background: linear-gradient(135deg, #0088cc, #006699);
      color: white;
      border: none;
      padding: 14px 20px;
      border-radius: 14px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      width: 100%;
      margin-top: 15px;
      transition: all 0.3s ease;
    }
    
    .share-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(0, 136, 204, 0.4);
    }
    
    .referral-count {
      background: linear-gradient(135deg, #1a1a3a, #2d2b55);
      padding: 20px;
      border-radius: 18px;
      text-align: center;
      margin-top: 25px;
      border: 1px solid rgba(0, 176, 155, 0.15);
    }
    
    .referral-count h3 {
      font-size: 36px;
      margin: 10px 0;
      color: #00b09b;
    }
    
    .earn-text {
      color: #00b09b;
    }
    
    .pulse {
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); }
    }
    
    /* Developer text animation */
    .developer-text {
      position: absolute;
      top: 55%;
      left: 0;
      width: 100%;
      text-align: center;
      font-size: 18px;
      font-weight: bold;
      color: rgba(0, 176, 155, 0.8);
      animation: slide 10s linear infinite;
      text-shadow: 0 0 10px rgba(0, 176, 155, 0.5);
      z-index: 10;
    }
    
    @keyframes slide {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }
    
    .ad-page {
      position: relative;
      min-height: 400px;
    }
  </style>
</head>
<body id="appBody" class="dark-theme">
<div class="app" id="homePage">
  <div class="app-name pulse">EASY EARN BD</div>
  <div class="balance-section">
    <h2 id="username">Loading...</h2>
    <p>Balance: <span class="earn-text">৳<span id="balance">0.00</span></span></p>
    <p>Score: <span class="earn-text"><span id="score">0</span></span> | Level: <span class="earn-text"><span id="level">0</span></span></p>
    <div class="level-bar">
      <div class="level-progress" id="levelProgress" style="width: 0%"></div>
    </div>
  </div>
  <div class="grid">
    <div class="card" onclick="goToAdPage()">
      <i class="fas fa-ad"></i>
      <span>Watch Ad</span>
    </div>
    <div class="card" onclick="goToNoticePage()">
      <i class="fas fa-bullhorn"></i>
      <span>Notice</span>
    </div>
    <div class="card" onclick="goToTopUsersPage()">
      <i class="fas fa-crown"></i>
      <span>Top Users</span>
    </div>
    <div class="card" onclick="openTelegramChannel()">
      <i class="fab fa-telegram"></i>
      <span>Channel</span>
    </div>
    <div class="card" onclick="goToWithdrawPage()">
      <i class="fas fa-wallet"></i>
      <span>Withdraw</span>
    </div>
    <div class="card" onclick="goToHistoryPage()">
      <i class="fas fa-history"></i>
      <span>History</span>
    </div>
    <div class="card" onclick="goToSupportPage()">
      <i class="fas fa-headset"></i>
      <span>Support</span>
    </div>
    <div class="card" onclick="goToReferralPage()">
      <i class="fas fa-user-friends"></i>
      <span>Refer</span>
    </div>
    <div class="card" onclick="goToSettingsPage()">
      <i class="fas fa-cog"></i>
      <span>Settings</span>
    </div>
  </div>
</div>

<div class="ad-page hidden" id="adPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="quiz-buttons">
    <button onclick="loadQuiz()"><i class="fas fa-play-circle"></i> Start Earning</button>
    <button onclick="loadQuiz()"><i class="fas fa-video"></i> Watch Premium Ad</button>
  </div>
  <div class="developer-text">Developer By SABBIR</div>
</div>

<div class="referral-page hidden" id="referralPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="section-title">
    <i class="fas fa-user-friends"></i>
    <h2>Referral Program</h2>
  </div>
  <p><strong>Your Referral Link:</strong></p>
  <div style="display: flex; align-items: center; margin-bottom: 20px;">
    <input type="text" id="referralLink" readonly />
    <button class="copy-btn" onclick="copyReferralLink()"><i class="fas fa-copy"></i> Copy</button>
  </div>
  <p style="font-size: 15px; margin-bottom: 25px; opacity: 0.8;">Share your referral link and earn rewards for every friend who joins!</p>
  <button class="share-btn" onclick="shareOnTelegram()">
    <i class="fab fa-telegram-plane"></i> Share on Telegram
  </button>
  
  <div class="referral-count">
    <p><strong>Total Referrals:</strong></p>
    <h3 id="referralCount">0</h3>
    <p>Active Users</p>
  </div>
</div>

<div class="notice-page hidden" id="noticePage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="notice-content">
    <div class="section-title">
      <i class="fas fa-bullhorn"></i>
      <h2>Important Notice</h2>
    </div>
    <p><strong class="earn-text">আয়ের সহজ ও নিরাপদ উপায়!*</strong> 💰📲</p>
    <p>আমাদের <span class="earn-text">EASY EARN BD</span> থেকে আপনি প্রতিদিন সহজ টাস্ক ও অ্যাড দেখে আয় করতে পারেন। ✅</p>
    <p>শুধু কাজ করুন, আয় করুন এবং সরাসরি <strong>বিকাশ/নগদে</strong> টাকা তুলুন। 🤑</p>
    <p>কোনো ইনভেস্টমেন্ট লাগবে না — <span class="earn-text">100% ফ্রি প্ল্যাটফর্ম!</span> 🔓</p>
    <p>🔥 প্রতিদিন লগইন করে রিওয়ার্ড নিন</p>
    <p>📥 ইনকাম রিপোর্ট চেক করুন</p>
    <p>💬 <span class="earn-text">সাপোর্ট</span> টিম সবসময় একটিভ</p>
    <p>👉 বেশি কাজ, বেশি ইনকাম!</p>
    <p>👉 নিয়মিত ব্যবহার করে নিশ্চিত আয় করুন।</p>
    <p><em>শুভ কামনা! ❤️</em></p>
    <p>— আপনার আয়ের সাথী <span class="earn-text">EASY EARN BD</span> ✨</p>
  </div>
</div>

<div class="withdraw-page hidden" id="withdrawPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="withdraw-form">
    <div class="section-title">
      <i class="fas fa-wallet"></i>
      <h2>টাকা উত্তোলন করুন</h2>
    </div>
    <p>আপনার উপার্জিত টাকা উত্তোলন করতে নিচের ফর্মটি পূরণ করুন:</p>
    
    <select id="withdrawMethod">
      <option value="">পেমেন্ট মেথড নির্বাচন করুন</option>
      <option value="bkash">বিকাশ</option>
      <option value="nagad">নগদ</option>
      <option value="rocket">রকেট</option>
    </select>
    
    <input type="text" id="accountNumber" placeholder="অ্যাকাউন্ট নম্বর (01XXXXXXXXX)" />
    
    <input type="number" id="withdrawAmount" placeholder="উত্তোলনের পরিমাণ (৳)" min="30" />
    
    <button onclick="submitWithdraw()"><i class="fas fa-paper-plane"></i> উত্তোলন রিকোয়েস্ট করুন</button>
    
    <p style="margin-top: 20px; font-size: 14px; color: #00b09b;">
      <strong>নোট:</strong> সর্বনিম্ন উত্তোলনের পরিমাণ ৳৩০.০০
    </p>
  </div>
</div>

<div class="settings-page hidden" id="settingsPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="theme-options">
    <div class="section-title">
      <i class="fas fa-palette"></i>
      <h2>App Appearance</h2>
    </div>
    <p>আপনার পছন্দ অনুযায়ী অ্যাপের থিম পরিবর্তন করুন:</p>
    
    <div class="theme-btn light-btn" onclick="setTheme('light')">
      <i class="fas fa-sun"></i>
      <span>হালকা থিম</span>
    </div>
    
    <div class="theme-btn dark-btn" onclick="setTheme('dark')">
      <i class="fas fa-moon"></i>
      <span>গাঢ় থিম</span>
    </div>
  </div>
</div>

<div class="support-page hidden" id="supportPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="support-options">
    <div class="section-title">
      <i class="fas fa-headset"></i>
      <h2>Support</h2>
    </div>
    <p>আপনার সমস্যার সমাধানের জন্য আমাদের সাথে যোগাযোগ করুন:</p>
    
    <div class="support-btn" onclick="openTelegramSupport()">
      <i class="fab fa-telegram"></i>
      <span>টেলিগ্রাম সাপোর্ট</span>
    </div>
    
    <div class="support-btn" onclick="openEmailSupport()">
      <i class="fas fa-envelope"></i>
      <span>ইমেইল সাপোর্ট</span>
    </div>
  </div>
</div>

<div class="top-users-page hidden" id="topUsersPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div class="user-stats">
    <div class="section-title">
      <i class="fas fa-crown"></i>
      <h2>User Stats</h2>
    </div>
    <p>আপনার অ্যাপ ব্যবহারের পরিসংখ্যান:</p>
    
    <div>
      <span>ব্যবহারকারীর নাম:</span>
      <span class="earn-text" id="topUserName">User Name</span>
    </div>
    
    <div>
      <span>বিজ্ঞাপন দেখা:</span>
      <span class="earn-text" id="adsWatched">0</span>
    </div>
    
    <div>
      <span>বর্তমান ব্যালেন্স:</span>
      <span class="earn-text">৳<span id="topUserBalance">0.00</span></span>
    </div>
    
    <div>
      <span>রেফার করা ডিভাইস:</span>
      <span class="earn-text" id="referralDevices">0</span>
    </div>
    
    <div>
      <span>উত্তোলনের সংখ্যা:</span>
      <span class="earn-text" id="withdrawCount">0</span>
    </div>
    
    <div>
      <span>ব্যবহৃত পেমেন্ট মাধ্যম:</span>
      <span class="earn-text" id="paymentMethods">None</span>
    </div>
  </div>
</div>

<div class="history-page hidden" id="historyPage">
  <div class="back-btn" onclick="goHome()"><i class="fas fa-arrow-left"></i> Back</div>
  <div>
    <div class="section-title">
      <i class="fas fa-history"></i>
      <h2>Transaction History</h2>
    </div>
    <p>আপনার সম্পূর্ণ উত্তোলনের রেকর্ড:</p>
    
    <div id="withdrawHistory">
      <!-- History items will be added here dynamically -->
    </div>
  </div>
</div>

<div id="quizModal" class="modal hidden">
  <div class="modal-content">
    <span class="close" onclick="closeQuizModal()">&times;</span>
    <div class="timer" id="quizTimer">5</div>
    <div class="quiz-question" id="quizQuestion">প্রশ্ন আসছে...</div>
    <div class="quiz-options" id="quizOptions"></div>
  </div>
</div>

<script>
  // Initialize Telegram WebApp
  let tg;
  let user;
  
  function initTelegram() {
    // Check if Telegram WebApp is available
    if (window.Telegram && window.Telegram.WebApp) {
      tg = window.Telegram.WebApp;
      tg.ready();
      user = tg.initDataUnsafe?.user;
      
      // Set username automatically
      const username = user ? `${user.first_name} ${user?.last_name || ''}` : "Guest";
      document.getElementById("username").innerText = username;
      document.getElementById("topUserName").innerText = username;
      console.log("Telegram user loaded:", username);
    } else {
      console.log("Telegram WebApp not detected");
      document.getElementById("username").innerText = "Guest";
      document.getElementById("topUserName").innerText = "Guest";
    }
  }
  
  // Generate unique referral link based on device ID
  function generateDeviceId() {
    return 'device-' + Math.random().toString(36).substr(2, 9) + '-' + Date.now().toString(36);
  }

  // Get or create device ID
  let deviceId = localStorage.getItem('deviceId');
  if (!deviceId) {
    deviceId = generateDeviceId();
    localStorage.setItem('deviceId', deviceId);
    console.log("Generated new device ID:", deviceId);
  }

  // Initialize all values to 0
  let balance = 50.00; // Starting balance for demo
  let score = 0;
  let level = 0;
  let referralCount = 0;
  let adsWatched = 0;
  let withdrawCount = 0;
  let paymentMethods = [];
  let withdrawHistory = [];

  // Load saved theme
  const savedTheme = localStorage.getItem('theme');
  if (savedTheme) {
    setTheme(savedTheme);
  } else {
    setTheme('dark');
  }

  const quizList = [
    { question: "বাংলাদেশের রাজধানী কোনটি?", options: ["চট্টগ্রাম", "ঢাকা", "রাজশাহী", "খুলনা"], answer: "ঢাকা" },
    { question: "৫ x ৬ = ?", options: ["৩০", "২৫", "৩৫", "৪০"], answer: "৩০" },
    { question: "সবচেয়ে বড় মহাসাগর কোনটি?", options: ["আটলান্টিক", "প্যাসিফিক", "ভারত", "আর্কটিক"], answer: "প্যাসিফিক" },
    { question: "বাংলাদেশ কবে স্বাধীনতা লাভ করে?", options: ["১৯৭১", "১৯৭৫", "১৯৪৭", "১৯৯০"], answer: "১৯৭১" },
    { question: "বর্তমানে বাংলাদেশের প্রধানমন্ত্রী কে?", options: ["খালেদা জিয়া", "শেখ হাসিনা", "এরশাদ", "জিয়া রহমান"], answer: "শেখ হাসিনা" },
    { question: "সূর্যের সবচেয়ে কাছের গ্রহ কোনটি?", options: ["বুধ", "শুক্র", "পৃথিবী", "মঙ্গল"], answer: "বুধ" },
    { question: "বাংলাদেশের জাতীয় পশু কোনটি?", options: ["বাঘ", "হাতি", "ঘোড়া", "ভাল্লুক"], answer: "বাঘ" },
    { question: "জলীয় বাষ্প জমে কী তৈরি হয়?", options: ["তুষার", "কুয়াশা", "বৃষ্টি", "সাগর"], answer: "কুয়াশা" },
    { question: "পৃথিবীর সবচেয়ে বড় মহাদেশ কোনটি?", options: ["ইউরোপ", "এশিয়া", "আফ্রিকা", "দক্ষিণ আমেরিকা"], answer: "এশিয়া" },
    { question: "বাংলাদেশের মুদ্রার নাম কী?", options: ["রুপি", "টাকা", "ডলার", "ইউরো"], answer: "টাকা" },
    { question: "গ্রামাঞ্চলের মানুষ প্রধানত কী কাজ করে?", options: ["মৎস্য শিকার", "চাষাবাদ", "শিক্ষকতা", "ব্যবসা"], answer: "চাষাবাদ" },
    { question: "আব্রাহাম লিংকন কোন দেশের রাষ্ট্রপতি ছিলেন?", options: ["যুক্তরাজ্য", "বাংলাদেশ", "যুক্তরাষ্ট্র", "জাপান"], answer: "যুক্তরাষ্ট্র" },
    { question: "রবীন্দ্রনাথ ঠাকুর কোন ভাষায় লিখতেন?", options: ["হিন্দি", "বাংলা", "ইংরেজি", "উর্দু"], answer: "বাংলা" },
    { question: "কম্পিউটারের জনক কাকে বলা হয়?", options: ["আইজ্যাক নিউটন", "চার্লস ব্যাবেজ", "টমাস এডিসন", "আলবার্ট আইনস্টাইন"], answer: "চার্লস ব্যাবেজ" },
    { question: "এক ডজন মানে কত?", options: ["৬", "১০", "১২", "২০"], answer: "১২" },
    { question: "দক্ষিণ মেরুতে সবচেয়ে বেশি দেখা যায় কোন প্রাণী?", options: ["সিংহ", "ভাল্লুক", "পেঙ্গুইন", "হরিণ"], answer: "পেঙ্গুইন" },
    { question: "সূর্য কোথা থেকে উঠে?", options: ["পশ্চিম", "উত্তর", "পূর্ব", "দক্ষিণ"], answer: "পূর্ব" },
    { question: "বাংলাদেশের জাতীয় ফুল কী?", options: ["গোলাপ", "শাপলা", "জুঁই", "সূর্যমুখী"], answer: "শাপলা" },
    { question: "সমুদ্রের পানির স্বাদ কেমন?", options: ["মিষ্টি", "লবণাক্ত", "ফিকে", "ঝাল"], answer: "লবণাক্ত" },
    { question: "প্রথম মানুষ চাঁদে অবতরণ করেন কবে?", options: ["১৯৬৯", "১৯৭৫", "১৯৮০", "১৯৫০"], answer: "১৯৬৯" }
  ];

  let quizTimerInterval;

  function updateBalance() {
    document.getElementById("balance").innerText = balance.toFixed(2);
    document.getElementById("score").innerText = score;
    document.getElementById("level").innerText = level;
    updateLevelProgress();
  }
  
  function updateLevelProgress() {
    const progress = (score % 20) * 5;
    document.getElementById("levelProgress").style.width = `${progress}%`;
  }

  function goToNoticePage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("noticePage").classList.remove("hidden");
  }

  function goToWithdrawPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("withdrawPage").classList.remove("hidden");
  }

  function goToSettingsPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("settingsPage").classList.remove("hidden");
  }

  function goToSupportPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("supportPage").classList.remove("hidden");
  }

  function goToTopUsersPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("topUsersPage").classList.remove("hidden");
    
    // Update top user stats
    document.getElementById("adsWatched").innerText = adsWatched;
    document.getElementById("topUserBalance").innerText = balance.toFixed(2);
    document.getElementById("referralDevices").innerText = referralCount;
    document.getElementById("withdrawCount").innerText = withdrawCount;
    document.getElementById("paymentMethods").innerText = paymentMethods.join(", ") || "None";
  }

  function goToHistoryPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("historyPage").classList.remove("hidden");
    updateWithdrawHistory();
  }

  function openTelegramChannel() {
    window.open("https://t.me/EAS_YEARN_BD", "_blank");
  }

  function openTelegramSupport() {
    window.open("https://t.me/EAS_YEARN_BD", "_blank");
  }

  function openEmailSupport() {
    window.location.href = "mailto:support@easyearnbd.com";
  }

  function goToAdPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("adPage").classList.remove("hidden");
  }

  function goHome() {
    document.getElementById("homePage").classList.remove("hidden");
    document.getElementById("adPage").classList.add("hidden");
    document.getElementById("referralPage").classList.add("hidden");
    document.getElementById("noticePage").classList.add("hidden");
    document.getElementById("withdrawPage").classList.add("hidden");
    document.getElementById("settingsPage").classList.add("hidden");
    document.getElementById("supportPage").classList.add("hidden");
    document.getElementById("topUsersPage").classList.add("hidden");
    document.getElementById("historyPage").classList.add("hidden");
  }

  function goToReferralPage() {
    document.getElementById("homePage").classList.add("hidden");
    document.getElementById("referralPage").classList.remove("hidden");

    // Use Telegram user ID if available, otherwise use device ID
    const userId = user ? user.id : deviceId;
    const referralLink = `https://easyearnbd.com/?ref=${userId}`;
    document.getElementById("referralLink").value = referralLink;
    document.getElementById("referralCount").innerText = referralCount;
    console.log("Referral link generated:", referralLink);
  }

  function copyReferralLink() {
    const input = document.getElementById("referralLink");
    input.select();
    input.setSelectionRange(0, 99999);
    document.execCommand("copy");
    
    // Visual feedback
    const btn = document.querySelector('.copy-btn');
    btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
    setTimeout(() => {
      btn.innerHTML = '<i class="fas fa-copy"></i> Copy';
    }, 2000);
  }

  function shareOnTelegram() {
    const link = document.getElementById("referralLink").value;
    const text = encodeURIComponent("🚀 Join EASY EARN BD and earn rewards! " + link);
    window.open(`https://t.me/share/url?url=${text}`, "_blank");
  }

  function loadQuiz() {
    const quiz = quizList[Math.floor(Math.random() * quizList.length)];
    document.getElementById("quizModal").classList.remove("hidden");
    document.getElementById("quizQuestion").innerText = quiz.question;

    const optionsEl = document.getElementById("quizOptions");
    optionsEl.innerHTML = "";

    quiz.options.forEach(opt => {
      const btn = document.createElement("button");
      btn.innerText = opt;
      btn.onclick = () => {
        clearInterval(quizTimerInterval);
        if (opt === quiz.answer) {
          alert("✅ সঠিক উত্তর! আপনার ব্যালেন্স আপডেট করা হয়েছে");
          balance += 0.20;
          score += 1;
          adsWatched += 1;
          if (score % 20 === 0) level += 1;
        } else {
          alert("❌ ভুল উত্তর! পরের বার চেষ্টা করুন");
          adsWatched += 1;
        }
        updateBalance();
        closeQuizModal();
      };
      optionsEl.appendChild(btn);
    });

    startQuizTimer();
  }

  function startQuizTimer() {
    let timeLeft = 5;
    const timerEl = document.getElementById("quizTimer");
    timerEl.innerText = timeLeft;

    quizTimerInterval = setInterval(() => {
      timeLeft--;
      timerEl.innerText = timeLeft;

      if (timeLeft <= 0) {
        clearInterval(quizTimerInterval);
        alert("🕒 সময় শেষ! পরের বার চেষ্টা করুন");
        adsWatched += 1;
        updateBalance();
        closeQuizModal();
      }
    }, 1000);
  }

  function closeQuizModal() {
    document.getElementById("quizModal").classList.add("hidden");
    clearInterval(quizTimerInterval);
  }

  function submitWithdraw() {
    const method = document.getElementById("withdrawMethod").value;
    const account = document.getElementById("accountNumber").value;
    const amount = parseFloat(document.getElementById("withdrawAmount").value);
    
    if (!method) {
      alert("পেমেন্ট মেথড নির্বাচন করুন");
      return;
    }
    
    if (!account || account.length < 11) {
      alert("সঠিক অ্যাকাউন্ট নম্বর দিন");
      return;
    }
    
    if (!amount || amount < 30) {
      alert("সর্বনিম্ন উত্তোলনের পরিমাণ ৳৩০");
      return;
    }
    
    if (amount > balance) {
      alert("আপনার ব্যালেন্স যথেষ্ট নয়");
      return;
    }
    
    balance -= amount;
    withdrawCount += 1;
    if (!paymentMethods.includes(method)) {
      paymentMethods.push(method);
    }
    
    // Add to withdraw history
    const now = new Date();
    const historyItem = {
      method: method,
      account: account,
      amount: amount,
      date: now.toLocaleDateString('bn-BD'),
      time: now.toLocaleTimeString('bn-BD')
    };
    withdrawHistory.push(historyItem);
    
    updateBalance();
    alert("✅ আপনার উত্তোলন রিকোয়েস্ট জমা হয়েছে! ২৪ ঘন্টার মধ্যে টাকা পেয়ে যাবেন");
    goHome();
  }

  function updateWithdrawHistory() {
    const historyContainer = document.getElementById("withdrawHistory");
    historyContainer.innerHTML = "";
    
    if (withdrawHistory.length === 0) {
      historyContainer.innerHTML = '<div class="history-item"><p>কোনো উত্তোলনের ইতিহাস পাওয়া যায়নি</p></div>';
      return;
    }
    
    withdrawHistory.forEach(item => {
      const historyItem = document.createElement("div");
      historyItem.className = "history-item";
      
      historyItem.innerHTML = `
        <div>
          <span>পেমেন্ট মাধ্যম:</span>
          <span class="earn-text">${getMethodName(item.method)}</span>
        </div>
        <div>
          <span>অ্যাকাউন্ট নম্বর:</span>
          <span>${item.account}</span>
        </div>
        <div>
          <span>পরিমাণ:</span>
          <span class="earn-text">৳${item.amount.toFixed(2)}</span>
        </div>
        <div>
          <span>তারিখ:</span>
          <span>${item.date}</span>
        </div>
        <div>
          <span>সময়:</span>
          <span>${item.time}</span>
        </div>
      `;
      
      historyContainer.appendChild(historyItem);
    });
  }

  function getMethodName(method) {
    switch(method) {
      case 'bkash': return 'বিকাশ';
      case 'nagad': return 'নগদ';
      case 'rocket': return 'রকেট';
      default: return method;
    }
  }

  function setTheme(theme) {
    const body = document.getElementById("appBody");
    body.className = theme + '-theme';
    localStorage.setItem('theme', theme);
    
    // Add subtle animation to cards
    const cards = document.querySelectorAll('.card');
    cards.forEach(card => {
      card.style.animation = 'pulse 0.5s ease';
      setTimeout(() => {
        card.style.animation = '';
      }, 500);
    });
  }
  
  // Initialize app
  initTelegram();
  updateBalance();
  
  // Add animation for app name
  const appName = document.querySelector('.app-name');
  setInterval(() => {
    appName.style.textShadow = '0 0 15px rgba(0, 176, 155, 0.7)';
    setTimeout(() => {
      appName.style.textShadow = '0 2px 8px rgba(0,0,0,0.2)';
    }, 1000);
  }, 3000);
</script>
</body>
</html>
